# Script Parser Skill (劇本拆分)

## 🎯 核心任務
將已有劇本的「場景」合併為「集數」

## ⚠️ 關鍵規則：場景 ≠ 集數

### 場景 (Scene)
- 單一時空連續動作
- 通常 100-500 字
- 標記：「場景1」「SCENE 1」「INT.」「EXT.」

### 集 (Episode)  
- 完整敘事單元
- 包含 **3-8 個場景**
- 每集 1500-3000 字
- 時長 5-10 分鐘

### 合併公式
```
總場景數 ÷ 5 ≈ 集數

例：23場景 ÷ 5 = 4-5集
例：50場景 ÷ 5 = 10集
```

---

## 📊 合併原則（三幕結構）

### 第一集：建置 (Setup)
- 世界觀介紹
- 主角登場
- 核心衝突鋪墊
- 通常包含前 20-25% 的場景

### 中間集：對抗 (Confrontation)
- 遞進障礙
- 角色發展
- 中點反轉
- 約 50% 的場景

### 最後集：解決 (Resolution)
- 高潮對決
- 真相揭露
- 新平衡
- 最後 25% 的場景

---

## 🔍 識別分割點

### 情節分割信號
- ⏰ 時間跳躍：「三天後」「次日」
- 🌍 空間大轉換：城市→海上
- 🎭 重大事件：角色死亡、真相揭露
- 💔 情感轉折：反目、和好

### 場景標記模式
```regex
場景\s*(\d+)
SCENE\s*(\d+)
第(\d+)場
【(.+?)】- 
INT\.|EXT\.
```

---

## 📤 輸出格式

```json
{
  "title": "劇本標題",
  "total_scenes": 23,
  "total_episodes": 4,
  "detected_format": "場景式劇本",
  
  "episodes": [
    {
      "ep": 1,
      "title": "登船（建置）",
      "scenes": ["場景1", "場景2", "場景3", "場景4", "場景5", "場景6"],
      "scene_range": "1-6",
      "word_count": 2000,
      "duration_min": 7,
      "act": "第一幕",
      "summary": "小猴子登上商船，認識船上各色人物"
    },
    {
      "ep": 2,
      "title": "秘密（發展）",
      "scenes": ["場景7", "場景8", "場景9", "場景10", "場景11", "場景12"],
      "scene_range": "7-12",
      "word_count": 2200,
      "duration_min": 8,
      "act": "第二幕A",
      "summary": "船上秘密浮現，船長被害"
    }
  ],
  
  "characters": [
    {"name": "小猴子", "role": "主角", "appearances": 20},
    {"name": "小菩薩蠻", "role": "女主", "appearances": 12}
  ],
  
  "summary": {
    "total_words": 8000,
    "total_duration": "30分鐘",
    "structure": "四集完結"
  }
}
```

---

## 🎬 《海上絲綢之路》示例拆分

### 原始：23場景 + 引子
### 合併後：4集

| 集 | 場景 | 標題 | 幕 |
|---|------|------|---|
| 1 | 引子+1-6 | 廣州：盜夢少年 | 建置 |
| 2 | 7-12 | 商船：暗流湧動 | 發展A |
| 3 | 13-18 | 曼陀羅：夢境相連 | 發展B |
| 4 | 19-23 | 迷宮：生死循環 | 高潮 |

---

## ✅ 檢查清單

- [ ] 每集包含 3-8 個場景？
- [ ] 每集 1500-3000 字？
- [ ] 按三幕結構分佈？
- [ ] 每集有獨立的敘事弧？
- [ ] 集末有懸念/鉤子？
