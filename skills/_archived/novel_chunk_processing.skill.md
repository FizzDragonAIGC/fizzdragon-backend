# 長篇小說分段處理技能

## 核心理念
將長篇小說切分為可管理的段落，每段獨立分析，最終聚合。

## 分段策略

### 分段原則
1. **尊重章節邊界**: 不在章節中間切斷
2. **控制段落大小**: 每段6000-10000字
3. **保持上下文**: 段落間有200字重疊
4. **標記連續性**: 記錄跨段角色和線索

### 分段大小建議
| 小說類型 | 建議段落大小 | 原因 |
|----------|--------------|------|
| 對話密集 | 8000字 | 信息密度低 |
| 描寫密集 | 6000字 | 信息密度高 |
| 動作密集 | 10000字 | 需要完整場景 |
| 心理描寫 | 5000字 | 需要細緻分析 |

## 單段分析維度

### 必須提取
1. **角色列表**
   - 本段出場角色
   - 新登場角色（標記 🆕）
   - 角色關係變化

2. **場景列表**
   - 場景地點
   - 場景時間
   - 場景氛圍

3. **關鍵事件**
   - 推動劇情的事件
   - 揭示信息的事件
   - 情感轉折點

4. **對話精華**
   - 關鍵對話（不超過5組）
   - 潛台詞分析
   - 角色聲音特徵

5. **情緒曲線**
   - 本段開始情緒
   - 本段結束情緒
   - 情緒轉折點

### 連續性追蹤
```json
{
  "carryOver": {
    "unresolvedConflicts": ["衝突1仍在發展"],
    "activeCharacters": ["角色A", "角色B"],
    "pendingPlots": ["伏筆X待揭曉"],
    "emotionalState": "緊張升級中"
  }
}
```

## 段落間銜接

### 前段摘要傳遞
```
前段結束狀態:
- 最後場景: [場景名]
- 在場角色: [角色列表]
- 未完事件: [事件列表]
- 情緒狀態: [狀態]
```

### 本段開始確認
```
本段開始確認:
- 場景是否延續: 是/否
- 新角色登場: [列表]
- 時間跳躍: [時間跨度]
```

## 分集映射

### 單段→集數映射
```
段落A (8000字) → 第1-2集
  場景1-3 → 第1集
  場景4-6 → 第2集

段落B (6000字) → 第3集
  全部場景 → 第3集
```

### 關鍵場景標記
- ⭐ 必須保留（劇情關鍵）
- 🔥 高潮場景（視覺重點）
- 💔 情感場景（表演重點）
- 🎭 對話場景（台詞重點）

## 輸出格式

```json
{
  "chunkId": 1,
  "chunkRange": "第1-5章",
  "wordCount": 8000,
  "characters": [
    {"name": "張三", "role": "主角", "firstAppearance": true},
    {"name": "李四", "role": "配角", "firstAppearance": true}
  ],
  "scenes": [
    {"location": "小鎮", "time": "清晨", "mood": "平靜"}
  ],
  "keyEvents": [
    {"event": "主角收到神秘信件", "importance": "高", "type": "inciting"}
  ],
  "dialogueHighlights": [
    {"speaker": "張三", "line": "這封信會改變一切", "subtext": "預感命運轉折"}
  ],
  "emotionalArc": {
    "start": "平靜日常",
    "end": "懸念升起",
    "turning": "打開信件瞬間"
  },
  "suggestedEpisodes": [1, 2],
  "carryOver": {
    "unresolvedConflicts": ["信件內容未揭曉"],
    "activeCharacters": ["張三"],
    "pendingPlots": ["神秘寄信人是誰"]
  }
}
```
